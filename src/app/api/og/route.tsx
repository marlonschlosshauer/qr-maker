import { ImageResponse } from "next/og";
import { QRCodeSVG } from "qrcode.react";

export const runtime = "edge";

export async function GET(request: any) {
  const { searchParams } = request.nextUrl;
  const query = searchParams.get("q") ?? process.env.BASE_URL;

  return new ImageResponse(
    (
      <div
        style={{
          display: "flex",
          height: "100%",
          width: "100%",
          justifyContent: "center",
          alignItems: "center",
          backgroundColor: "#000",
        }}
      >
        <div
          style={{
            display: "flex",
            flex: "1 1 0",
            height: "100%",
            alignItems: "center",
            justifyContent: "center",
          }}
        >
          <QRCodeSVG fgColor="white" bgColor="black" value={query} size={400} />
        </div>
        <div
          style={{
            display: "flex",
            flex: "1 1 0",
            height: "100%",
            justifyContent: "center",
            alignItems: "center",
          }}
        >
          <svg
            width="600"
            height="630"
            viewBox="0 0 600 630"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <rect
              width="600"
              height="630"
              fill="url(#paint0_linear_2958_480)"
            />
            <path
              d="M250.31 140.818H267.724L282.497 176.841H283.179L297.952 140.818H315.366V199H301.673V163.261H301.19L287.213 198.631H278.463L264.486 163.062H264.003V199H250.31V140.818ZM336.723 199H321.609L341.24 140.818H359.962L379.592 199H364.479L350.814 155.477H350.359L336.723 199ZM334.706 176.102H366.297V186.784H334.706V176.102ZM385.857 199V140.818H399.919V165.42H400.686L419.919 140.818H436.482L415.857 166.784L436.851 199H420.033L405.544 176.131L399.919 183.233V199H385.857ZM442.028 199V140.818H482.597V152.239H456.091V164.17H480.523V175.619H456.091V187.58H482.597V199H442.028Z"
              fill="white"
            />
            <path
              d="M117.732 296V237.818H141.766C146.122 237.818 149.881 238.67 153.044 240.375C156.226 242.061 158.679 244.419 160.402 247.449C162.125 250.46 162.987 253.964 162.987 257.96C162.987 261.975 162.107 265.489 160.345 268.5C158.603 271.492 156.112 273.812 152.874 275.46C149.635 277.108 145.79 277.932 141.339 277.932H126.51V266.852H138.726C140.847 266.852 142.618 266.483 144.038 265.744C145.478 265.006 146.567 263.973 147.305 262.648C148.044 261.303 148.413 259.741 148.413 257.96C148.413 256.161 148.044 254.608 147.305 253.301C146.567 251.975 145.478 250.953 144.038 250.233C142.599 249.513 140.828 249.153 138.726 249.153H131.794V296H117.732ZM169.919 296V237.818H193.953C198.309 237.818 202.069 238.604 205.232 240.176C208.413 241.729 210.866 243.964 212.589 246.881C214.313 249.778 215.175 253.216 215.175 257.193C215.175 261.227 214.294 264.655 212.533 267.477C210.771 270.28 208.271 272.42 205.033 273.898C201.794 275.356 197.959 276.085 193.527 276.085H178.328V265.006H190.913C193.035 265.006 194.805 264.731 196.226 264.182C197.665 263.614 198.754 262.761 199.493 261.625C200.232 260.47 200.601 258.992 200.601 257.193C200.601 255.394 200.232 253.907 199.493 252.733C198.754 251.54 197.665 250.65 196.226 250.062C194.786 249.456 193.016 249.153 190.913 249.153H183.982V296H169.919ZM202.675 269.409L217.163 296H201.822L187.618 269.409H202.675ZM222.888 296V237.818H263.456V249.239H236.95V261.17H261.382V272.619H236.95V284.58H263.456V296H222.888ZM285.473 237.818L298.484 280.432H298.967L311.979 237.818H327.717L308.087 296H289.365L269.734 237.818H285.473ZM348.044 237.818V296H333.982V237.818H348.044ZM356.872 296V237.818H397.44V249.239H370.935V261.17H395.366V272.619H370.935V284.58H397.44V296H356.872ZM420.196 296L403.264 237.818H418.804L427.582 275.943H428.065L438.094 237.818H450.764L460.793 276.028H461.276L470.082 237.818H485.594L468.69 296H455.139L444.656 260.716H444.202L433.719 296H420.196Z"
              fill="white"
              fill-opacity="0.8"
            />
            <path
              d="M246.134 352.261C245.944 350.178 245.101 348.559 243.605 347.403C242.128 346.229 240.016 345.642 237.27 345.642C235.452 345.642 233.937 345.879 232.724 346.352C231.512 346.826 230.603 347.479 229.997 348.312C229.391 349.127 229.079 350.064 229.06 351.125C229.022 351.996 229.192 352.763 229.571 353.426C229.969 354.089 230.537 354.676 231.276 355.188C232.033 355.68 232.942 356.116 234.003 356.494C235.063 356.873 236.257 357.205 237.582 357.489L242.582 358.625C245.461 359.25 247.999 360.083 250.196 361.125C252.412 362.167 254.268 363.407 255.764 364.847C257.279 366.286 258.425 367.943 259.202 369.818C259.978 371.693 260.376 373.795 260.395 376.125C260.376 379.799 259.448 382.953 257.611 385.585C255.774 388.218 253.132 390.235 249.685 391.636C246.257 393.038 242.118 393.739 237.27 393.739C232.402 393.739 228.16 393.009 224.543 391.551C220.925 390.093 218.113 387.877 216.105 384.903C214.098 381.93 213.065 378.17 213.009 373.625H226.474C226.588 375.5 227.09 377.062 227.98 378.312C228.87 379.562 230.092 380.509 231.645 381.153C233.217 381.797 235.035 382.119 237.099 382.119C238.993 382.119 240.603 381.864 241.929 381.352C243.274 380.841 244.306 380.131 245.026 379.222C245.745 378.312 246.115 377.271 246.134 376.097C246.115 374.998 245.774 374.061 245.111 373.284C244.448 372.489 243.425 371.807 242.043 371.239C240.679 370.652 238.937 370.112 236.815 369.619L230.736 368.199C225.698 367.044 221.73 365.178 218.832 362.602C215.935 360.008 214.495 356.504 214.514 352.091C214.495 348.492 215.461 345.339 217.412 342.631C219.363 339.922 222.062 337.811 225.509 336.295C228.955 334.78 232.885 334.023 237.298 334.023C241.806 334.023 245.717 334.79 249.031 336.324C252.365 337.839 254.95 339.97 256.787 342.716C258.624 345.462 259.562 348.644 259.599 352.261H246.134ZM267.497 393V334.818H281.56V358.17H304.486V334.818H318.52V393H304.486V369.619H281.56V393H267.497ZM339.926 393H324.812L344.443 334.818H363.165L382.795 393H367.682L354.017 349.477H353.562L339.926 393ZM337.909 370.102H369.5V380.784H337.909V370.102ZM389.06 393V334.818H413.094C417.45 334.818 421.209 335.604 424.372 337.176C427.554 338.729 430.007 340.964 431.73 343.881C433.454 346.778 434.315 350.216 434.315 354.193C434.315 358.227 433.435 361.655 431.673 364.477C429.912 367.28 427.412 369.42 424.173 370.898C420.935 372.356 417.099 373.085 412.668 373.085H397.469V362.006H410.054C412.175 362.006 413.946 361.731 415.366 361.182C416.806 360.614 417.895 359.761 418.634 358.625C419.372 357.47 419.741 355.992 419.741 354.193C419.741 352.394 419.372 350.907 418.634 349.733C417.895 348.54 416.806 347.65 415.366 347.062C413.927 346.456 412.156 346.153 410.054 346.153H403.122V393H389.06ZM421.815 366.409L436.304 393H420.963L406.759 366.409H421.815ZM442.028 393V334.818H482.597V346.239H456.091V358.17H480.523V369.619H456.091V381.58H482.597V393H442.028Z"
              fill="white"
              fill-opacity="0.6"
            />
            <path
              d="M178.903 490V431.818H202.938C207.294 431.818 211.053 432.604 214.216 434.176C217.398 435.729 219.85 437.964 221.574 440.881C223.297 443.778 224.159 447.216 224.159 451.193C224.159 455.227 223.278 458.655 221.517 461.477C219.756 464.28 217.256 466.42 214.017 467.898C210.778 469.356 206.943 470.085 202.511 470.085H187.312V459.006H199.898C202.019 459.006 203.79 458.731 205.21 458.182C206.65 457.614 207.739 456.761 208.477 455.625C209.216 454.47 209.585 452.992 209.585 451.193C209.585 449.394 209.216 447.907 208.477 446.733C207.739 445.54 206.65 444.65 205.21 444.062C203.771 443.456 202 443.153 199.898 443.153H192.966V490H178.903ZM211.659 463.409L226.148 490H210.807L196.602 463.409H211.659ZM231.872 490V431.818H272.44V443.239H245.935V455.17H270.366V466.619H245.935V478.58H272.44V490H231.872ZM281.247 490V431.818H305.281C309.637 431.818 313.397 432.67 316.56 434.375C319.741 436.061 322.194 438.419 323.918 441.449C325.641 444.46 326.503 447.964 326.503 451.96C326.503 455.975 325.622 459.489 323.861 462.5C322.118 465.492 319.628 467.812 316.389 469.46C313.151 471.108 309.306 471.932 304.855 471.932H290.026V460.852H302.241C304.363 460.852 306.134 460.483 307.554 459.744C308.993 459.006 310.082 457.973 310.821 456.648C311.56 455.303 311.929 453.741 311.929 451.96C311.929 450.161 311.56 448.608 310.821 447.301C310.082 445.975 308.993 444.953 307.554 444.233C306.115 443.513 304.344 443.153 302.241 443.153H295.31V490H281.247ZM333.435 490V431.818H374.003V443.239H347.497V455.17H371.929V466.619H347.497V478.58H374.003V490H333.435ZM395.395 490H380.281L399.912 431.818H418.634L438.264 490H423.151L409.486 446.477H409.031L395.395 490ZM393.378 467.102H424.969V477.784H393.378V467.102ZM435.359 443.239V431.818H484.536V443.239H466.893V490H453.03V443.239H435.359Z"
              fill="white"
              fill-opacity="0.4"
            />
            <defs>
              <linearGradient
                id="paint0_linear_2958_480"
                x1="600"
                y1="314.999"
                x2="-2.20056e-06"
                y2="314.999"
                gradientUnits="userSpaceOnUse"
              >
                <stop stop-color="#7775D2" />
                <stop offset="0.508015" stop-color="#0097A7" />
                <stop offset="1" stop-color="#FDB913" />
              </linearGradient>
            </defs>
          </svg>
        </div>
      </div>
    ),
    {
      width: 1200,
      height: 630,
    }
  );
}
